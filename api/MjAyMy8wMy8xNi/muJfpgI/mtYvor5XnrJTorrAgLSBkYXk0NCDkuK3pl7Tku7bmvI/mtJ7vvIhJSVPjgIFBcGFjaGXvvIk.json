{"title":"渗透测试笔记 - day44 中间件漏洞（IIS、Apache）","date":"2023-03-16T17:42:18.147Z","date_formatted":{"ll":"Mar 16, 2023","L":"03/16/2023","MM-DD":"03-16"},"link":"2023/03/16/渗透测试笔记 - day44 中间件漏洞（IIS、Apache）","updated":"2023-03-11T14:33:03.758Z","content":"<h2 id=\"iis7.0-7.5-fast-cgi解析漏洞（iis、apache）\">IIS7.0-7.5 fast-cgi解析漏洞（IIS、Apache）<a title=\"#iis7.0-7.5-fast-cgi解析漏洞（iis、apache）\" href=\"#iis7.0-7.5-fast-cgi解析漏洞（iis、apache）\"></a></h2>\n<p>环境：Windows Server 2008 / IIS7.0 / php5.2.17</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204021911514.png\" alt=\"image-20220402191151429\" loading=\"lazy\" class=\"φbp\"></p>\n<ul>\n<li>通过访问xxx.jpg/.php文件，IIS7会保留其最后的后缀名，并以该方式解析为xxx.jpg</li>\n</ul>\n<h3 id=\"漏洞复现：\">漏洞复现：<a title=\"#漏洞复现：\" href=\"#漏洞复现：\"></a></h3>\n<p>开启cgi（修改php.ini文件中cgi.fix_pathinfo=1）并重启服务</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051835108.png\" alt=\"image-20220402191438987\" loading=\"lazy\" class=\"φbp\"></p>\n<p>网站根目录下新建jpg文件并写入phpinfo</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204021918481.png\" alt=\"image-20220402191843408\" loading=\"lazy\" class=\"φbp\"></p>\n<p>访问</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204022012842.png\" alt=\"image-20220402201205754\" loading=\"lazy\" class=\"φbp\"></p>\n<p>实验完成。</p>\n<h2 id=\"apche解析漏洞\">apche解析漏洞<a title=\"#apche解析漏洞\" href=\"#apche解析漏洞\"></a></h2>\n<ul>\n<li>由于apache从后往前解析文件后缀名，非可解析后缀名都会被略过，因此会产生文件解析漏洞</li>\n</ul>\n<p>环境：Windows 10 / apache + php5.2.17</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051835323.png\" alt=\"image-20220402201557773\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"漏洞复现\">漏洞复现<a title=\"#漏洞复现\" href=\"#漏洞复现\"></a></h3>\n<p><a href=\"http://xn--1-mo6a72at28b7ma602afia12pf63bsgisxm.php.xxx\">网站根目录下新建文件1.php.xxx</a>(随便填无效的后缀名)并写入phpinfo()</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204022018910.png\" alt=\"image-20220402201815814\" loading=\"lazy\" class=\"φbp\"></p>\n<p>编辑httpd.conf添加解析方式</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AddType application/x-httpd-php .php .phtml</span><br><span class=\"line\">&lt;/Ifmodule&gt;</span><br></pre></td></tr></table></figure>\n<p>访问该文件</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204022150268.png\" alt=\"image-20220402215027150\" loading=\"lazy\" class=\"φbp\"></p>\n<p>实验完成。</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204022158596.png\" alt=\"image-20220402215837538\" loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"渗透测试笔记 - day43 中间件漏洞（IIS）","link":"2023/03/16/渗透测试笔记 - day43 中间件漏洞（IIS）"},"next":{"title":"渗透测试笔记 - day45 中间件漏洞（Apache、Nginx、Weblogic）","link":"2023/03/16/渗透测试笔记 - day45 中间件漏洞（Apache、Nginx、Weblogic）"},"plink":"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day44 中间件漏洞（IIS、Apache）/","toc":[{"id":"iis7.0-7.5-fast-cgi解析漏洞（iis、apache）","title":"IIS7.0-7.5 fast-cgi解析漏洞（IIS、Apache）","index":"1","children":[{"id":"漏洞复现：","title":"漏洞复现：","index":"1.1"}]},{"id":"apche解析漏洞","title":"apche解析漏洞","index":"2","children":[{"id":"漏洞复现","title":"漏洞复现","index":"2.1"}]}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"March 16, 2023","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day44 中间件漏洞（IIS、Apache）/\" title=\"渗透测试笔记 - day44 中间件漏洞（IIS、Apache）\">https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day44 中间件漏洞（IIS、Apache）/</a>"},"reading_time":"292 words in 2 min"}