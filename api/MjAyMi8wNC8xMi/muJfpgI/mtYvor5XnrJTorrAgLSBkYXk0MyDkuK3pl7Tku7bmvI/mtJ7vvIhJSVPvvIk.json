{"title":"渗透测试笔记 - day43 中间件漏洞（IIS）","date":"2022-04-12T00:00:00.000Z","date_formatted":{"ll":"Apr 12, 2022","L":"04/12/2022","MM-DD":"04-12"},"link":"2022/04/12/渗透测试笔记 - day43 中间件漏洞（IIS）","updated":"2023-03-17T12:07:41.497Z","content":"<h2 id=\"iis6.0文件解析漏洞\">IIS6.0文件解析漏洞<a title=\"#iis6.0文件解析漏洞\" href=\"#iis6.0文件解析漏洞\"></a></h2>\n<p>环境：Windows Server 2003 / IIS6.0</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204021846662.png\" alt=\"image-20220401205321705\" loading=\"lazy\" class=\"φbp\"></p>\n<ul>\n<li>文件解析漏洞：将文件名命名为XX.asp;.jpg的时候，IIS服务器会忽略分号之后的内容</li>\n</ul>\n<h3 id=\"漏洞复现\">漏洞复现<a title=\"#漏洞复现\" href=\"#漏洞复现\"></a></h3>\n<p>写入一句话木马文件并命名为index.asp;.jpg</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204012058287.png\" alt=\"image-20220401205820503\" loading=\"lazy\" class=\"φbp\"></p>\n<p>尝试连接木马</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204012100391.png\" alt=\"image-20220401210029154\" loading=\"lazy\" class=\"φbp\"></p>\n<p>连接成功。</p>\n<h3 id=\"漏洞修复：\">漏洞修复：<a title=\"#漏洞修复：\" href=\"#漏洞修复：\"></a></h3>\n<p>升级IIS版本</p>\n<h2 id=\"iis6.0目录解析漏洞\">IIS6.0目录解析漏洞<a title=\"#iis6.0目录解析漏洞\" href=\"#iis6.0目录解析漏洞\"></a></h2>\n<p>环境：Windows Server 2003 / IIS6.0</p>\n<ul>\n<li>文件夹解析漏洞：当文件夹命名为xx.asp时，文件夹内的所有文件都将会被当作asp文件解析</li>\n</ul>\n<h3 id=\"漏洞复现-1\">漏洞复现<a title=\"#漏洞复现-1\" href=\"#漏洞复现-1\"></a></h3>\n<p>写入一句话木马并存放于以.asp结尾命名的文件夹中</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204012102680.png\" alt=\"image-20220401210246635\" loading=\"lazy\" class=\"φbp\"></p>\n<p>尝试连接木马</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202204012103407.png\" alt=\"image-20220401210342361\" loading=\"lazy\" class=\"φbp\"></p>\n<p>连接成功。</p>\n<h3 id=\"漏洞修复：-1\">漏洞修复：<a title=\"#漏洞修复：-1\" href=\"#漏洞修复：-1\"></a></h3>\n<p>升级IIS版本</p>\n","prev":{"title":"渗透测试笔记 - day44 中间件漏洞（IIS、Apache）","link":"2022/04/15/渗透测试笔记 - day44 中间件漏洞（IIS、Apache）"},"next":{"title":"渗透测试笔记 - day42 Linux应急响应","link":"2022/04/11/渗透测试笔记 - day42 Linux应急响应"},"plink":"https://Lq0ne.github.io/2022/04/12/渗透测试笔记 - day43 中间件漏洞（IIS）/","toc":[{"id":"iis6.0文件解析漏洞","title":"IIS6.0文件解析漏洞","index":"1","children":[{"id":"漏洞复现","title":"漏洞复现","index":"1.1"},{"id":"漏洞修复：","title":"漏洞修复：","index":"1.2"}]},{"id":"iis6.0目录解析漏洞","title":"IIS6.0目录解析漏洞","index":"2","children":[{"id":"漏洞复现-1","title":"漏洞复现","index":"2.1"},{"id":"漏洞修复：-1","title":"漏洞修复：","index":"2.2"}]}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"April 12, 2022","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2022/04/12/渗透测试笔记 - day43 中间件漏洞（IIS）/\" title=\"渗透测试笔记 - day43 中间件漏洞（IIS）\">https://Lq0ne.github.io/2022/04/12/渗透测试笔记 - day43 中间件漏洞（IIS）/</a>"},"reading_time":"239 words in 2 min"}