{"title":"渗透测试笔记（进阶篇） - day2 信息泄露实战（复现CVE-2021-34429）","date":"2022-04-03T00:00:00.000Z","date_formatted":{"ll":"Apr 3, 2022","L":"04/03/2022","MM-DD":"04-03"},"link":"2022/04/03/渗透测试笔记（进阶篇） - day2 信息泄露实战（复现CVE-2021-34429）","updated":"2023-03-18T13:40:44.613Z","content":"<h2 id=\"信息泄露漏洞概述\">信息泄露漏洞概述<a title=\"#信息泄露漏洞概述\" href=\"#信息泄露漏洞概述\"></a></h2>\n<p>敏感数据包括但不限于：口令、密钥、证书、会话标识、License、隐私数据(如短消 息的内容)、授权凭据、个人数据(如姓名、住址、电话等)等。 在程序文件、配置文件、日志文件、备份文件及数据库中都有可能包含敏感数据。主要分为由版本管理软件导致的泄露, 文件包含导致的泄露和配置错误导致的泄露。</p>\n<p>常见如：</p>\n<ul>\n<li>未能从公共内容中删除内部内容\n<ul>\n<li>例如，在生产环境中，用户有时可以看到开发人员在加价中的评论。</li>\n</ul>\n</li>\n<li>网站及相关技术配置不安全\n<ul>\n<li>例如，如果无法禁用调试和诊断功能，有时可能会为攻击者提供有用的工具，帮助他们获取敏感信息。</li>\n<li>默认配置也会使网站变得脆弱。例如，通过显示过于冗长的错误消息。</li>\n</ul>\n</li>\n<li>应用程序的设计和行为缺陷\n<ul>\n<li>例如，如果网站在出现不同错误状态时返回不同的响应，这也可以允许攻击者列举敏感数据，例如有效的用户凭据。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"漏洞危害\">漏洞危害<a title=\"#漏洞危害\" href=\"#漏洞危害\"></a></h2>\n<ol>\n<li>扫描内网开放服务</li>\n<li>向内部任意主机的任意端口发送payload来攻击内网服务</li>\n<li>DOS攻击（请求大文件，始终保持连接Keep-Alive Always）</li>\n<li>攻击内网的web应用，例如直接SQL注入、XSS攻击等</li>\n<li>利用file、gopher、dict协议读取本地文件、执行命令等</li>\n</ol>\n<h3 id=\"测试方法\">测试方法<a title=\"#测试方法\" href=\"#测试方法\"></a></h3>\n<ol>\n<li>工具爬虫、关键词爆破</li>\n<li>手工挖掘、根据web容器或者网页源代码的查看；GithubHack</li>\n</ol>\n<h3 id=\"漏洞类型\">漏洞类型<a title=\"#漏洞类型\" href=\"#漏洞类型\"></a></h3>\n<ol>\n<li>phpinfo()信息泄露</li>\n<li>编辑器备份文件信息泄露<br>\n如.php.bak、.php.bak、.test.jsp.old、/cgi~</li>\n<li>版本管理工具文件信息泄露<br>\n如.git/config、/CVS/Entriesp、/.svn/entriesp</li>\n<li>HTTP认证信息泄露<br>\n/basic/index.php</li>\n<li>管理后台地址泄露</li>\n<li>员工邮箱、分机号码泄露</li>\n<li>错误页面信息泄露</li>\n<li>操作系统版本（nmap）</li>\n<li>中间件的类型、版本（http返回头、404、whatweb、cmd identify）</li>\n<li>网站信息泄露（DNS域传送漏洞运维监控系统弱口令、网络拓扑泄露、zabbix弱口令、zabbix sql注入等）</li>\n<li>第三方软件应用（github源码、数据库、邮箱密码泄露）</li>\n</ol>\n<h2 id=\"实验：复现cve-2021-34429_jetty-web-inf-敏感信息泄露漏洞\">实验：复现CVE-2021-34429_Jetty WEB-INF 敏感信息泄露漏洞<a title=\"#实验：复现cve-2021-34429_jetty-web-inf-敏感信息泄露漏洞\" href=\"#实验：复现cve-2021-34429_jetty-web-inf-敏感信息泄露漏洞\"></a></h2>\n<h3 id=\"概述：\">概述：<a title=\"#概述：\" href=\"#概述：\"></a></h3>\n<p>Eclipse Jetty是一个开源的servlet容器，它为基于Java的Web容器提供运行环境。</p>\n<p>Jetty在9.4.40后修复了因为<code>%2e</code>导致的敏感信息泄露漏洞<a href=\"https://github.com/vulhub/vulhub/tree/master/jetty/CVE-2021-28164\" target=\"_blank\">CVE-2021-28164</a>，但这个修复是不完全的，通过下面三种方式可以进行绕过：</p>\n<ul>\n<li>unicode形式URL编码：<code>/%u002e/WEB-INF/web.xml</code></li>\n<li><code>\\0</code>组合<code>.</code>导致的绕过：<code>/.%00/WEB-INF/web.xml</code></li>\n<li><code>\\0</code>组合<code>..</code>导致的绕过：<code>/a/b/..%00/WEB-INF/web.xml</code></li>\n</ul>\n<p>影响版本：9.4.37-9.4.42, 10.0.1-10.0.5, 11.0.1-11.0.5</p>\n<p>参考链接：</p>\n<ul>\n<li><a href=\"https://github.com/eclipse/jetty.project/security/advisories/GHSA-vjv5-gp2w-65vm\" target=\"_blank\">https://github.com/eclipse/jetty.project/security/advisories/GHSA-vjv5-gp2w-65vm</a></li>\n<li><a href=\"https://xz.aliyun.com/t/10039\" target=\"_blank\">https://xz.aliyun.com/t/10039</a></li>\n</ul>\n<h3 id=\"漏洞环境：\">漏洞环境：<a title=\"#漏洞环境：\" href=\"#漏洞环境：\"></a></h3>\n<p>vulhub/docker/wsl2-ubuntu</p>\n<p>启动环境：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303182126819.png\" alt=\"image-20230318212641592\" loading=\"lazy\" class=\"φbp\"></p>\n<p>访问主机8080端口</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303182140862.png\" alt=\"image-20230318212827391\" loading=\"lazy\" class=\"φbp\"></p>\n<p>能看到exmaple页面了。尝试访问敏感目录/WEB-INF/web.xml</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303182129261.png\" alt=\"image-20230318212936204\" loading=\"lazy\" class=\"φbp\"></p>\n<p>失败，返回了404</p>\n<p>利用CVE-2021-34429漏洞，使用<code>/%u002e/WEB-INF/web.xml</code>来绕过限制下载web.xml：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303182131695.png\" alt=\"image-20230318213128587\" loading=\"lazy\" class=\"φbp\"></p>\n<p>复现成功，实验完成</p>\n","prev":{"title":"渗透测试笔记 - day39、40 复习","link":"2022/04/03/渗透测试笔记 - day39、40 复习"},"next":{"title":"渗透测试笔记 - day38 信息收集","link":"2022/04/02/渗透测试笔记 - day38 信息收集"},"plink":"https://Lq0ne.github.io/2022/04/03/渗透测试笔记（进阶篇） - day2 信息泄露实战（复现CVE-2021-34429）/","toc":[{"id":"信息泄露漏洞概述","title":"信息泄露漏洞概述","index":"1"},{"id":"漏洞危害","title":"漏洞危害","index":"2","children":[{"id":"测试方法","title":"测试方法","index":"2.1"},{"id":"漏洞类型","title":"漏洞类型","index":"2.2"}]},{"id":"实验：复现cve-2021-34429_jetty-web-inf-敏感信息泄露漏洞","title":"实验：复现CVE-2021-34429_Jetty WEB-INF 敏感信息泄露漏洞","index":"3","children":[{"id":"概述：","title":"概述：","index":"3.1"},{"id":"漏洞环境：","title":"漏洞环境：","index":"3.2"}]}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"April 3, 2022","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2022/04/03/渗透测试笔记（进阶篇） - day2 信息泄露实战（复现CVE-2021-34429）/\" title=\"渗透测试笔记（进阶篇） - day2 信息泄露实战（复现CVE-2021-34429）\">https://Lq0ne.github.io/2022/04/03/渗透测试笔记（进阶篇） - day2 信息泄露实战（复现CVE-2021-34429）/</a>"},"reading_time":"911 words in 6 min"}